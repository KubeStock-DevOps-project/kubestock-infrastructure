# Nginx configuration for Kubernetes API proxy
# This proxies requests from localhost:6443 to the control plane
# Used by worker nodes to join and communicate with the cluster

error_log stderr notice;

worker_processes 1;

events {
    multi_accept on;
}

stream {
    upstream kube_apiserver {
        least_conn;
        # Control plane IP - update this for your cluster
        server 10.0.10.21:6443;
    }

    server {
        listen        127.0.0.1:6443;
        proxy_pass    kube_apiserver;
        proxy_timeout 10m;
        proxy_connect_timeout 1s;
    }
}
